---
title: "automatization_notebook_04"
output:
  html_document:
    df_print: paged
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

setwd("C:/Users/enami/Downloads/biostat_homework_092024/")
knitr::opts_knit$set(root.dir = "C:/Users/enami/Downloads/biostat_homework_092024/")
```

# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–í –≤–∞—à–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç healthcare-dataset-stroke-data.

```{r}

data <- read.csv('./data/raw/healthcare-dataset-stroke-data.csv', sep = ',', header = TRUE)
#–ø—É—Å—Ç—å id –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –±—É–¥—É—Ç –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —Å—Ç—Ä–æ–∫:
rownames(data) <- data$id
data <- data[,-1]
head(data)
```

# –í—ã–≤–µ–¥–∏—Ç–µ –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```{r}
dim(data) #—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫, —Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤
str(data)
summary(data)
```

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö: –Ω–∞—á–∞–ª–æ

1) –£–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –±–æ–ª—å—à–µ 20% –∏–ª–∏ —É–±–µ—Ä–∏—Ç–µ —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –ò–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏—Ç–µ –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞. –ù–∞–ø–∏—à–∏—Ç–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ, –ø–æ—á–µ–º—É –≤—ã –≤—ã–±—Ä–∞–ª–∏ —Ç–æ—Ç –∏–ª–∏ –∏–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç.

–°–Ω–∞—á–∞–ª–∞ –≤—Å–µ-—Ç–∞–∫–∏ –ø—Ä–∏–≤–µ–¥–µ–º –¥–∞–Ω–Ω—ã–µ –∫ –Ω—É–∂–Ω–æ–º—É —Ç–∏–ø—É, –∞ –ø–æ—Ç–æ–º –∑–∞–π–º–µ–º—Å—è –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:
```{r}
data$gender <- as.factor(data$gender)
data$age <- as.integer(data$age)
data$hypertension <- as.factor(data$hypertension)
data$heart_disease <- as.factor(data$heart_disease)
data$ever_married <- as.factor(data$ever_married)
data$work_type <- as.factor(data$work_type)
data$Residence_type <- as.factor(data$Residence_type)
data$avg_glucose_level <- as.numeric(data$avg_glucose_level)
data$bmi <- as.numeric(data$bmi)
data$smoking_status <- as.factor(data$smoking_status)
data$stroke <- as.factor(data$stroke)
```

# –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –≤ –∫–∞–∂–¥–æ–π —Ç–∞–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π?

```{r}
str(data)
summary(data)
```
–ú—ã –≤–∏–¥–∏–º, —á—Ç–æ: 

- –≤ —Å—Ç–æ–ª–±—Ü–µ gender –∏–º–µ–µ—Ç—Å—è –æ–¥–∏–Ω —Å–ª—É—á–∞–π —Å gender=Other,

- –≤ —Å—Ç–æ–ª–±—Ü–µ bmi –µ—Å—Ç—å **201 –ø—Ä–æ–ø—É—Å–∫** (NA), —á—Ç–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `r paste0(round(201/dim(data)[1]*100, 2), "%")` –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —Å—É–±—ä–µ–∫—Ç–æ–≤, 

- –≤ —Å—Ç–æ–ª–±—Ü–µ smoking_status –µ—Å—Ç—å **1544 –ø—Ä–æ–ø—É—Å–∫–∞** (Unknown), —á—Ç–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `r paste0(round(1544/dim(data)[1]*100, 2), "%")` –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —Å—É–±—ä–µ–∫—Ç–æ–≤.

–¢–µ–ø–µ—Ä—å –ø–æ—Å–º–æ—Ç—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ —Å—É–±—ä–µ–∫—Ç–æ–≤ –∏–º–µ—é—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è bmi –∏ smoking_status.
```{r}
dim(data %>%
  filter(is.na(bmi) & smoking_status == "Unknown"))[1]
```

–ò—Ç–∞–∫, —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –≤ 2 —Å—Ç–æ–ª–±—Ü–∞—Ö –∏–º–µ–µ—Ç—Å—è **61 —á–µ–ª–æ–≤–µ–∫**, —á—Ç–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `r paste0(round(dim(data %>% filter(is.na(bmi) & smoking_status == "Unknown"))[1]/dim(data)[1]*100, 2), "%")` –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —Å—É–±—ä–µ–∫—Ç–æ–≤, —á—Ç–æ –æ—á–µ–Ω—å –º–∞–ª–æ. 

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ—á–∏—Å—Ç–∫–∏:**
–î–æ–ª—è —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ 2 —Å—Ç–æ–ª–±—Ü–∞—Ö –æ—á–µ–Ω—å –º–∞–ª–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–∞–∫–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –Ω–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Å–∏–ª—å–Ω–æ–π –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç —É–¥–∞–ª–∏—Ç—å —Å—É–±—ä–µ–∫—Ç–∞ —Å gender=Other, —Ç–∞–∫ –∫–∞–∫ 1 –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –Ω–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö –≤—ã–≤–æ–¥–æ–≤ –æ–± –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å –¥–∞–Ω–Ω—ã–º –ø–æ–ª–æ–º. –ß—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ (bmi, smoking_status), —Å—Ç–æ–∏—Ç —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é  smoking_status, —Ç–∞–∫ –∫–∞–∫ –¥–æ–ª—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –Ω–µ–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–µ–ª–∏–∫–∞ (–±–æ–ª—å—à–µ 20%), –∏ –µ—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å –ø—Ä–æ–ø—É—Å–∫–æ–º smoking_status, —Å—É–±—ä–µ–∫—Ç–æ–≤ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ. –î–æ–ª—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π bmi –º–∞–ª–∞ –∏ –Ω–µ —Å—Ç–æ–∏—Ç —É–¥–∞–ª—è—Ç—å –µ–µ, –≤–µ–¥—å –æ–Ω–∞ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –≤–∞–∂–Ω—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º.
–ò—Ç–∞–∫, –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é smoking_status, –∞ –ø–æ—Ç–æ–º —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ–ª–∞ Other –∏ –ø—Ä–æ–ø—É—Å–∫–æ–º –≤ –∏–Ω–¥–µ–∫—Å–µ –º–∞—Å—Å–∞ —Ç–µ–ª–∞. 

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö: –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ

```{r}
data2 <- data
data2$smoking_status <- NULL
data2 <- data2 %>%
  filter(gender != "Other" & !is.na(bmi))
data2 <- droplevels(data2)
```


# –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö?

```{r}
dim(data2)[2]
```

# –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–ª—É—á–∞–µ–≤?

```{r}
dim(data2)[1]
```

2) –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥ (—á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö?);

–ü—Ä–æ–±–µ–ª—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –∏–º–µ–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π smoking_status, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞. –û—Å—Ç–∞–ª–æ—Å—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –æ–¥–Ω—É –∏–∑ –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –±–æ–ª—å—à–µ–π –æ–¥–Ω–æ—Ç–∏–ø–Ω–æ—Å—Ç–∏:
```{r}
names(data2)[names(data2) == 'Residence_type'] <- 'residence_type'
```

3) –í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫ –Ω—É–∂–Ω–æ–º—É —Ç–∏–ø—É (numeric –∏–ª–∏ factor);
(–±—ã–ª–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤—ã—à–µ)

4) –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –ø–æ —É–±—ã–≤–∞–Ω–∏—é;
```{r}
data3 <- data2 %>%
  arrange(desc(age))
```

5) –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª outliers.csv —Å—É–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –≤—ã–±—Ä–æ—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –ø—Ä–∞–≤–∏–ª—É —Ç—Ä—ë—Ö —Å–∏–≥–º) ‚Äî —ç—Ç–æ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π;

–°–æ–∑–¥–∞–¥–∏–º –¥–∞—Ç–∞—Å–µ—Ç—ã —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ age, avg_glucose_level –∏ bmi, –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º —á–∏—Å–ª–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Å—É–±—ä–µ–∫—Ç–æ–≤:
```{r}
data3_outliers_by_age <- data3 %>%
  filter(age >= mean(data3$age) + 3*sd(data3$age) | age <= mean(data3$age) - 3*sd(data3$age))

dim(data3_outliers_by_age)[1]

data3_outliers_by_avg_glucose_level <- data3 %>%
  filter(avg_glucose_level >= mean(data3$avg_glucose_level) + 3*sd(data3$avg_glucose_level) | avg_glucose_level <= mean(data3$avg_glucose_level) - 3*sd(data3$avg_glucose_level))

dim(data3_outliers_by_avg_glucose_level)[1]

data3_outliers_by_bmi <- data3 %>%
  filter(bmi >= mean(data3$bmi) + 3*sd(data3$bmi) | bmi <= mean(data3$bmi) - 3*sd(data3$bmi))
         
dim(data3_outliers_by_bmi)[1]
```

–¢–µ–ø–µ—Ä—å —Å–æ–µ–¥–∏–Ω–∏–º –¥–∞—Ç–∞—Å–µ—Ç—ã –∏ —É–¥–∞–ª–∏–º —É –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Å—Ç—Ä–æ–∫–∏-–¥—É–±–ª–∏–∫–∞—Ç—ã:
```{r}
data3_outliers <- rbind(data3_outliers_by_avg_glucose_level, data3_outliers_by_bmi)
sum(duplicated(data3_outliers))
data3_outliers <- data3_outliers[!duplicated(data3_outliers), ]
```


```{r}
write.csv(data3_outliers, file = 'outliers.csv')
```

6) –ü—Ä–∏—Å–≤–æ–π—Ç–µ –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –¥–∞—Ç–∞—Å–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π "cleaned_data".
```{r}
cleaned_data <- data3
```

# –ï—Å—Ç—å –ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏?

```{r}
sum(duplicated(data))
sum(duplicated(cleaned_data))
```
–ò–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –Ω–µ—Ç –Ω–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ, –Ω–µ –≤ –∫–æ–Ω–µ—á–Ω–æ–º.

# –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –¥–ª—è –≤—Å–µ—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã (stroke):

1.1) –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π;

–†–∞—Å—Å—á–∏—Ç–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞, –∏ –¥–ª—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ (–ø–æ—á–∏—â–µ–Ω–Ω–æ–≥–æ).
```{r}
rows_count <- function(df) {
  number_of_rows <- df %>%
    group_by(stroke) %>%
    count()
  return(number_of_rows)
}

rows_count(data)
rows_count(cleaned_data)

```
1.2) –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π;

–†–∞—Å—Å—á–∏—Ç–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞, –∏ –¥–ª—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ (–ø–æ—á–∏—â–µ–Ω–Ω–æ–≥–æ).
```{r}

na_count <- function(df, colname) {
  number_of_na <- df %>%
    group_by(stroke) %>%
    filter(is.na({{colname}})) %>%
    count()
  return(number_of_na)
}

na_count(data, age)
na_count(data, avg_glucose_level)
na_count(data, bmi)

na_count(cleaned_data, age)
na_count(cleaned_data, avg_glucose_level)
na_count(cleaned_data, bmi)

```
–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è bmi –¥–æ –æ—á–∏—Å—Ç–∫–∏. –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ—Ç - –æ–Ω–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ.

1.3) –°—Ä–µ–¥–Ω–µ–µ;
```{r}
mean_calc <- function(df, colname) {
  means <- df %>%
    group_by(stroke) %>%
    summarise(mean = mean({{colname}}))
  return(means)
}

mean_calc(cleaned_data, age)
mean_calc(cleaned_data, avg_glucose_level)
mean_calc(cleaned_data, bmi)
```
1.4) –ú–µ–¥–∏–∞–Ω—É;
```{r}
median_calc <- function(df, colname) {
  medians <- df %>%
    group_by(stroke) %>%
    summarise(median = median({{colname}}))
  return(medians)
}

median_calc(cleaned_data, age)
median_calc(cleaned_data, avg_glucose_level)
median_calc(cleaned_data, bmi)
```

1.5) –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ;

```{r}
sd_calc <- function(df, colname) {
  sds <- df %>%
    group_by(stroke) %>%
    summarise(sd = sd({{colname}}))
  return(sds)
}

sd_calc(cleaned_data, age)
sd_calc(cleaned_data, avg_glucose_level)
sd_calc(cleaned_data, bmi)
```

1.6) 25% –∫–≤–∞–Ω—Ç–∏–ª—å –∏ 75% –∫–≤–∞–Ω—Ç–∏–ª—å;
```{r}
quantile_calc <- function(df, colname) {
  quantiles <- df %>%
    group_by(stroke) %>%
    reframe(quantile = quantile({{colname}}, probs = c(0.25, 0.75)))
  return(quantiles)
}

quantile_calc(cleaned_data, age)
quantile_calc(cleaned_data, avg_glucose_level)
quantile_calc(cleaned_data, bmi)
```
1.7) –ò–Ω—Ç–µ—Ä–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–∞—Ö;

```{r}
IQR_calc <- function(df, colname) {
  IQRs <- df %>%
    group_by(stroke) %>%
    reframe(IQR = IQR({{colname}}))
  return(IQRs)
}

IQR_calc(cleaned_data, age)
IQR_calc(cleaned_data, avg_glucose_level)
IQR_calc(cleaned_data, bmi)
```

1.8) –ú–∏–Ω–∏–º—É–º;
```{r}
min_calc <- function(df, colname) {
  mins <- df %>%
    group_by(stroke) %>%
    summarise(min = min({{colname}}))
  return(mins)
}

min_calc(cleaned_data, age)
min_calc(cleaned_data, avg_glucose_level)
min_calc(cleaned_data, bmi)
```
1.9) –ú–∞–∫—Å–∏–º—É–º;
```{r}
max_calc <- function(df, colname) {
  maxs <- df %>%
    group_by(stroke) %>%
    summarise(max = max({{colname}}))
  return(maxs)
}

max_calc(cleaned_data, age)
max_calc(cleaned_data, avg_glucose_level)
max_calc(cleaned_data, bmi)
```
1.10) 95% –î–ò –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ - –∑–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π.

```{r}
confint_calc <- function(df, colname) {
  confints <- df %>%
    group_by(stroke) %>%
    reframe(confint = t.test({{colname}})$conf.int)
  return(confints)
}

confint_calc(cleaned_data, age)
confint_calc(cleaned_data, avg_glucose_level)
confint_calc(cleaned_data, bmi)
```

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã (stroke):


1.1) –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ;
–†–∞—Å—Å—á–∏—Ç–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞, –∏ –¥–ª—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ (–ø–æ—á–∏—â–µ–Ω–Ω–æ–≥–æ).
```{r}

rows_types_count <- function(df, colname) {
  number_of_rows_types <- df %>%
    group_by(stroke, {{colname}}) %>%
    count()
  return(number_of_rows_types)
}

print(rows_types_count(data, gender))
rows_types_count(data, hypertension)
rows_types_count(data, heart_disease)
rows_types_count(data, ever_married)
rows_types_count(data, work_type)
rows_types_count(data, Residence_type)
rows_types_count(data, smoking_status)

rows_types_count(cleaned_data, gender)
rows_types_count(cleaned_data, hypertension)
rows_types_count(cleaned_data, heart_disease)
rows_types_count(cleaned_data, ever_married)
rows_types_count(cleaned_data, work_type)
rows_types_count(cleaned_data, residence_type)

```

1.2) –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã;

```{r}

rows_types_proportion <- function(df, colname) {
  proportion_of_rows_types <- df %>%
    group_by(stroke, {{colname}}) %>%
    summarise(n=n()) %>%
    mutate(proportion = n/sum(n))
  return(proportion_of_rows_types)
}

print(rows_types_proportion(data, gender))
rows_types_proportion(data, hypertension)
rows_types_proportion(data, heart_disease)
rows_types_proportion(data, ever_married)
rows_types_proportion(data, work_type)
rows_types_proportion(data, Residence_type)
rows_types_proportion(data, smoking_status)

rows_types_proportion(cleaned_data, gender)
rows_types_proportion(cleaned_data, hypertension)
rows_types_proportion(cleaned_data, heart_disease)
rows_types_proportion(cleaned_data, ever_married)
rows_types_proportion(cleaned_data, work_type)
rows_types_proportion(cleaned_data, residence_type)

```

–ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å —Ç–µ –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ –≤—Ä—É—á–Ω—É—é:
```{r}
skimr::skim(data)
```

```{r}
skimr::skim(cleaned_data)
```

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

## –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–¥–µ–ª–∞–π—Ç–µ –±–æ–∫—Å–ø–ª–æ—Ç—ã –ø–æ –≥—Ä—É–ø–ø–∞–º. –†–∞—Å–ø–æ–ª–æ–∂–∏—Ç–µ –∏—Ö –ª–∏–±–æ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ä–∏—Å—É–Ω–∫–∞—Ö, –ª–∏–±–æ –Ω–∞ –æ–¥–Ω–æ–º, –Ω–æ —á–∏—Ç–∞–µ–º–æ;

2) –†–∞—Å–∫—Ä–∞—Å—å—Ç–µ –±–æ–∫—Å–ø–ª–æ—Ç—ã —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ RColorBrewer.

```{r}
library(RColorBrewer)
library(ggplot2)

boxes <- cleaned_data %>% 
  select("age", "avg_glucose_level", "bmi") %>%
  pivot_longer(everything(),
               names_to = "item",
               values_to = "scores") %>% 
  ggplot(aes(x = scores, color = item)) +
  geom_boxplot() +
  labs(y = "", x="") +
  theme(legend.position = "none") +
  facet_wrap(~item,scales = "free")

boxes + scale_color_brewer(palette="Dark2")
 


```

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –°–¥–µ–ª–∞–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –û–±–æ—Å–Ω—É–π—Ç–µ, –ø–æ—á–µ–º—É –≤—ã–±—Ä–∞–ª–∏ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç —Ç–∏–ø.

–ò–º–µ–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞–ª–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–≤ –æ—Å–Ω–æ–≤–Ω–æ–º - 2 —à—Ç—É–∫–∏), –ø–æ—ç—Ç–æ–º—É –Ω–∞–∏–ª—É—á—à–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ–¥—Ö–æ–¥–∏—Ç geom_bar. 
```{r}

bars <- cleaned_data %>% 
  select("gender", "hypertension", "heart_disease", "ever_married", "work_type", "residence_type") %>%
  pivot_longer(everything(),
               names_to = "item",
               values_to = "scores") %>% 
  ggplot(aes(x = scores, color = item)) +
  geom_bar(fill = "lightblue") +
  labs(y = "", x="") +
  theme(legend.position = "none") +
  facet_wrap(~item,scales = "free") +
  coord_flip()

bars + scale_color_brewer(palette="Dark2")

```


# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ü–µ–Ω–∫–∏

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å

1) –û—Ü–µ–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Å –ø–æ–º–æ—â—å—é —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞. –ö–∞–∫–∏–µ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —è–≤–ª—è—é—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ –∏ –∫–∞–∫ –∫–∞–∫ –≤—ã —ç—Ç–æ –ø–æ–Ω—è–ª–∏?

```{r}
shapiro.test(cleaned_data[['age']])
shapiro.test(cleaned_data[['avg_glucose_level']])
shapiro.test(cleaned_data[['bmi']])
```
–¢–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è age, avg_glucose_level –∏ bmi: –¢–∞–∫ –∫–∞–∫ p-value –º–µ–Ω—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05 (< 2e-16), —É –Ω–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ.


2) –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π QQ-–ø–ª–æ—Ç. –û—Ç–ª–∏—á–∞—é—Ç—Å—è –ª–∏ –≤—ã–≤–æ–¥—ã –æ—Ç —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞? –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –≤—ã –±—ã –ø—Ä–µ–¥–ø–æ—á–ª–∏ –∏ –ø–æ—á–µ–º—É?

```{r}
par(mfrow = c(1,3))

qqnorm(cleaned_data[['age']])
qqline(cleaned_data[['age']], col = "blue") #–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –ª–∏–Ω–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é

qqnorm(cleaned_data[['avg_glucose_level']])
qqline(cleaned_data[['avg_glucose_level']], col = "blue")

qqnorm(cleaned_data[['bmi']])
qqline(cleaned_data[['bmi']], col = "blue")
```
–í–æ –≤—Å–µ—Ö —Ç—Ä–µ—Ö —Å–ª—É—á–∞—è—Ö —Ç–æ—á–∫–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–æ –Ω–∞—à–∏–º –¥–∞–Ω–Ω—ã–º, –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è –æ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –ª–∏–Ω–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é, —Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –≠—Ç–æ —Å—Ö–æ–¥–∏—Ç—Å—è —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞.

3) –ù–∏–∂–µ –Ω–∞–ø–∏—à–∏—Ç–µ, –∫–∞–∫–∏–µ –µ—â—ë –º–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã –∑–Ω–∞–µ—Ç–µ –∏ –∫–∞–∫–∏–µ —É –Ω–∏—Ö –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.

–í–æ-–ø–µ—Ä–≤—ã—Ö, –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –æ–±—ã—á–Ω—É—é –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å, –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ.

–í–æ-–≤—Ç–æ—Ä—ã—Ö, –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞, –Ω–æ –æ–Ω –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –¥–ª–∏–Ω–µ –≤—ã–±–æ—Ä–∫–∏ (—Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –Ω–µ –º–µ–Ω–µ–µ 50, –ø—Ä–∏ 25-50 –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å –ø–æ–ø—Ä–∞–≤–∫–æ–π –ë–æ–ª—å—à–µ–≤–∞).

–í-—Ç—Ä–µ—Ç—å–∏—Ö, –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç –ê–Ω–¥–µ—Ä—Å–æ–Ω–∞-–î–∞—Ä–ª–∏–Ω–≥–∞ - –æ–Ω —Ç–∞–∫–∂–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –¥–ª–∏–Ω–µ –≤—ã–±–æ—Ä–∫–∏, –Ω–æ –≤ –º–µ–Ω—å—à–µ–π —Å—Ç–µ–ø–µ–Ω–∏ (—Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –Ω–µ –º–µ–Ω–µ–µ 8).


## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥—Ä—É–ø–ø

1) –°—Ä–∞–≤–Ω–∏—Ç–µ –≥—Ä—É–ø–ø—ã (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è **stroke**) –ø–æ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π, —Ç–∞–∫ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π). –î–ª—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –∏ –∫—Ä–∞—Ç–∫–æ –æ–±–æ—Å–Ω—É–π—Ç–µ –µ–≥–æ –≤—ã–±–æ—Ä –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö.

–ù–∞—á–Ω–µ–º —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - age, avg_glucose_level –∏ bmi. –¢–∞–∫ –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ z.test, –∞ t.test.
```{r}
stroke1_age <- cleaned_data[cleaned_data$stroke == "1", ]$age
stroke0_age <- cleaned_data[cleaned_data$stroke == "0", ]$age
t.test(x = stroke1_age, y = stroke0_age, alternative = "two.sided")

stroke1_avg_glucose_level <- cleaned_data[cleaned_data$stroke == "1", ]$avg_glucose_level
stroke0_avg_glucose_level <- cleaned_data[cleaned_data$stroke == "0", ]$avg_glucose_level
t.test(x = stroke1_avg_glucose_level, y = stroke0_avg_glucose_level, alternative = "two.sided")

stroke1_bmi <- cleaned_data[cleaned_data$stroke == "1", ]$bmi
stroke0_bmi <- cleaned_data[cleaned_data$stroke == "0", ]$bmi
t.test(x = stroke1_bmi, y = stroke0_bmi, alternative = "two.sided")
```
–î–ª—è age: –¢–∞–∫ –∫–∞–∫ p-value –º–µ–Ω—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05 (< 2e-16), —É –Ω–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –≤ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–∞–≤–Ω–æ 0, –∏ –ø—Ä–∏–Ω—è—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –≤ —Å—Ä–µ–¥–Ω–µ–º –≤–æ–∑—Ä–∞—Å—Ç–µ –º–µ–∂–¥—É —Å—É–±—ä–µ–∫—Ç–∞–º–∏, –∏—Å–ø—ã—Ç–∞–≤—à–∏–º–∏ —É–¥–∞—Ä, –∏ –Ω–µ –∏—Å–ø—ã—Ç–∞–≤—à–∏–º–∏ —É–¥–∞—Ä, –Ω–µ —Ä–∞–≤–Ω–æ 0. –ü—Ä–∏ —ç—Ç–æ–º —É –∏—Å–ø—ã—Ç–∞–≤—à–∏—Ö —É–¥–∞—Ä —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç –±–æ–ª—å—à–µ.

–î–ª—è avg_glucose_level: –¢–∞–∫ –∫–∞–∫ p-value –º–µ–Ω—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05 (< 2e-16), —É –Ω–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –≤ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–∞–≤–Ω–æ 0, –∏ –ø—Ä–∏–Ω—è—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –≤ —Å—Ä–µ–¥–Ω–µ–º —É—Ä–æ–≤–Ω–µ –≥–ª—é–∫–æ–∑—ã –º–µ–∂–¥—É —Å—É–±—ä–µ–∫—Ç–∞–º–∏, –∏—Å–ø—ã—Ç–∞–≤—à–∏–º–∏ —É–¥–∞—Ä, –∏ –Ω–µ –∏—Å–ø—ã—Ç–∞–≤—à–∏–º–∏ —É–¥–∞—Ä, –Ω–µ —Ä–∞–≤–Ω–æ 0. –ü—Ä–∏ —ç—Ç–æ–º —É –∏—Å–ø—ã—Ç–∞–≤—à–∏—Ö —É–¥–∞—Ä —Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –≥–ª—é–∫–æ–∑—ã –±–æ–ª—å—à–µ.

–î–ª—è bmi: –¢–∞–∫ –∫–∞–∫ p-value –±–æ–ª—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05 (0.0003377), —É –Ω–∞—Å –Ω–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –≤ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–∞–≤–Ω–æ 0.

–î–∞–ª–µ–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –¢–∞–∫ –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–π –∫–ª–µ—Ç–∫–µ —Å–≤–æ–¥–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –Ω–∏–∂–µ –±–æ–ª—å—à–µ 5, –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–µ—Å—Ç —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç, –∞ –Ω–µ —Ç–æ—á–Ω—ã–π —Ç–µ—Å—Ç –§–∏—à–µ—Ä–∞. 
```{r}
print("gender")
d1 <- table(cleaned_data$stroke, cleaned_data$gender)
d1
chisq.test(d1)

print("hypertension")
d2 <- table(cleaned_data$stroke, cleaned_data$hypertension)
d2
chisq.test(d2)

print("heart_disease")
d3 <- table(cleaned_data$stroke, cleaned_data$heart_disease)
d3
chisq.test(d3)

print("ever_married")
d4 <- table(cleaned_data$stroke, cleaned_data$ever_married)
d4
chisq.test(d4)

print("residence_type")
d6 <- table(cleaned_data$stroke, cleaned_data$residence_type)
d6
chisq.test(d6)
```
–î–ª—è gender, residence_type: –¢–∞–∫ –∫–∞–∫ p-value –±–æ–ª—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05, —É –Ω–∞—Å –Ω–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ñ–∞–∫—Ç–æ—Ä—ã –Ω–∞–ª–∏—á–∏–µ —É–¥–∞—Ä–∞ –∏ –ø–æ–ª, –Ω–∞–ª–∏—á–∏–µ —É–¥–∞—Ä–∞ –∏ —Ç–∏–ø –º–µ—Å—Ç–æ–∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã.

–î–ª—è hypertension, heart_disease, ever_married: –¢–∞–∫ –∫–∞–∫ p-value –º–µ–Ω—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05, —É –Ω–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ñ–∞–∫—Ç–æ—Ä—ã –Ω–∞–ª–∏—á–∏–µ —É–¥–∞—Ä–∞ –∏ –≥–∏–ø–µ—Ä—Ç–µ–Ω–∑–∏–∏, –Ω–∞–ª–∏—á–∏–µ —É–¥–∞—Ä–∞ –∏ –±–æ–ª–µ–∑–Ω–∏ —Å–µ—Ä–¥—Ü–∞, –Ω–∞–ª–∏—á–∏–µ —É–¥–∞—Ä–∞ –∏ —Ñ–∞–∫—Ç –∂–µ–Ω–∏—Ç—å–±—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã.

–í —Å–ª—É—á–∞–µ —Ç–∏–ø–∞ —Ä–∞–±–æ—Ç—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —è—á–µ–π–∫–∞—Ö —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 5:
```{r}
print("work_type")
d5 <- table(cleaned_data$stroke, cleaned_data$work_type)
d5
fisher.test(d5, workspace=2e9)
```
–î–ª—è hypertension, heart_disease, ever_married: –¢–∞–∫ –∫–∞–∫ p-value –º–µ–Ω—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05, —É –Ω–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ñ–∞–∫—Ç–æ—Ä—ã –Ω–∞–ª–∏—á–∏–µ —É–¥–∞—Ä–∞ –∏ —Ç–∏–ø —Ä–∞–±–æ—Ç—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã.


# –î–∞–ª–µ–µ –∏–¥—É—Ç **–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–µ—Å—Ç–∏ –≤–∞–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∞–ª–ª—ã –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö

## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

1) –°–æ–∑–¥–∞–π—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –ø–æ–ø—Ä–∞–≤–∫–æ–π –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –û–±—ä—è—Å–Ω–∏—Ç–µ, –∫–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∏ –≤ —á—ë–º –º–∏–Ω—É—Å—ã –∏ –ø–ª—é—Å—ã –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π.

–ü—Ä–∏–º–µ–Ω–∏–º –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –°–ø–∏—Ä–º–µ–Ω–∞, –∞ –Ω–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –ü–∏—Ä—Å–æ–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ:
```{r}
library(corrplot) 
cors <- cor(cleaned_data[,c("age", "avg_glucose_level", "bmi")], method = "spearman")
corrplot(cors, type = "upper", method="color")
```

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è - —ç—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –¥–≤—É—Ö –∏ –±–æ–ª–µ–µ –≤–µ–ª–∏—á–∏–Ω, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑ —ç—Ç–∏—Ö –≤–µ–ª–∏—á–∏–Ω —Å–æ–ø—É—Ç—Å—Ç–≤—É–µ—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–π –¥—Ä—É–≥–æ–π –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –≤–µ–ª–∏—á–∏–Ω. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–∏—à—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–∫—Ç –Ω–∞–ª–∏—á–∏—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –¥–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è - —Å–∏–ª–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏. –û—Å–æ–±–µ–Ω–Ω–æ –Ω–µ—É–¥–æ–±–Ω–æ —Ç–æ, —á—Ç–æ –º–Ω–æ–≥–∏–µ –º–µ—Ç–æ–¥—ã (–≤ —Ç.—á. –º–µ—Ç–æ–¥ –ü–∏—Ä—Å–æ–Ω–∞) —É–ª–∞–≤–ª–∏–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤—è–∑–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ–≥–æ –æ–±—ã—á–Ω–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –û–¥–Ω–∞–∫–æ, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤ —Ä–∞–∑–≤–µ–¥–æ—á–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, —á—Ç–æ–±—ã –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å, –∫–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –º–æ–≥—É—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –∑–Ω–∞—á–∏–º—ã–º–∏). 

## –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

1) –ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π **stroke**. –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è

–¢–∞–∫ –∫–∞–∫ stroke —è–≤–ª—è–µ—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–µ –ª–∏–π–Ω–µ–π–Ω—É—é, –∞ –±–∏–Ω–∞—Ä–Ω—É—é –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é. 
```{r}

model2 <- glm(stroke ~ gender + age + hypertension + heart_disease + ever_married + work_type + residence_type + avg_glucose_level + bmi, data = cleaned_data, family = "binomial")
summary(model2)
```
**–ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:**

1. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã. 

- –ü–æ–ª: –¢–∞–∫ –∫–∞–∫ p-value –±–æ–ª—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05 (0.972298), —É –Ω–∞—Å –Ω–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏–π –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ñ–∞–∫—Ç —É–¥–∞—Ä–∞ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ–ª–∞.
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫—Ä–æ–º–µ –≤–æ–∑—Ä–∞—Å—Ç–∞.

- –í–æ–∑—Ä–∞—Å—Ç: –¢–∞–∫ –∫–∞–∫ p-value –º–µ–Ω—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05 (< 2e-16), —É –Ω–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —Ñ–∞–∫—Ç —É–¥–∞—Ä–∞ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω–¥–µ–∫—Å–∞ –°–≠–°. –¢–æ –µ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç —É–¥–∞—Ä–∞, —Ç–æ –µ—Å—Ç—å —É —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å –±–æ–ª—å—à–∏–º –≤–æ–∑—Ä–∞—Å—Ç–æ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏–º–µ—Ç—å —É–¥–∞—Ä –±–æ–ª—å—à–µ.


2. –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏.
–ü—Ä–µ–¥—Å–∫–∞–∂–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—Å—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –≤—ã–≤–µ–¥–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å:
```{r}
cleaned_data$probabilities2 <- predict(model2, type = "response", newdata= cleaned_data) 
summary(cleaned_data$probabilities2)
cleaned_data$classification2 <- ifelse(cleaned_data$probabilities2 > 0.5, 1, 0)
accuracy <- mean(cleaned_data$classification2 == cleaned_data$stroke)
accuracy
```
–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ = 95.74%, —Ç–æ –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã—Å–æ–∫–∞.


**–ü—Ä–æ–≤–µ—Ä–∏–º –¥–æ–ø—É—â–µ–Ω–∏—è –±–∏–Ω–∞—Ä–Ω–æ–π –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:**

–í—Å–ø–æ–º–Ω–∏–º –¥–æ–ø—É—â–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π:
1. –õ–∏–Ω–µ–π–Ω–∞—è –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ù–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω–∞—è –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏ –ª–æ–≥–∏—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞!
2. –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –æ—à–∏–±–∫–∏ –Ω–µ –Ω–æ—Å—è—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
3. –ì–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
4. –û—à–∏–±–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω—ã: ùê∂ùëúùë£(ùúñùëñ,ùúñùëó) = 0 (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏) - —Ç—Ä–µ–±—É–µ—Ç—Å—è!
5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–µ–Ω–∏–∞—Ä–Ω–æ—Å—Ç–∏ (vif) - —Ç—Ä–µ–±—É–µ—Ç—Å—è!
6. –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

1. –°–≥–ª–∞–∂–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –≤–æ–∑—Ä–∞—Å—Ç –ª–∏–Ω–µ–π–Ω–æ —Å–≤—è–∑–∞–Ω—ã —Å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ –ª–æ–≥–∏—Ç-—à–∫–∞–ª–µ:
```{r}
mycleaned_data <- select(cleaned_data, age, probabilities2)
mycleaned_data <- mycleaned_data  %>%
  mutate(logit = log(probabilities2/(1-probabilities2))) %>%
  select(-probabilities2) %>%
  gather(key = "predictors", value = "predictor.value", -logit)

ggplot(mycleaned_data, aes(logit, predictor.value))+
  geom_point(size = 0.5, alpha = 0.5) +
  geom_smooth(method = "loess") + 
  theme_bw() + 
  facet_wrap(~predictors, scales = "free_y")
```

4. –û–¥–Ω–∞–∫–æ, –º–æ–∂–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ç–æ–º, —á—Ç–æ –µ—Å—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –æ—à–∏–±–æ–∫, —á—Ç–æ –≤–∏–¥–Ω–æ –ø–æ —Ç–µ—Å—Ç—É –î–∞—Ä–±–Ω–∞-–£–æ—Ç—Å–æ–Ω–∞ (DW < 2):
```{r}
lmtest::dwtest(model2)
```

5. –ú–æ–∂–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏, —á—Ç–æ –≤–∏–¥–Ω–æ –ø–æ —Ç–æ–º—É, —á—Ç–æ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ–Ω—å—à–µ 5 –∏ –±–ª–∏–∑–∫–∏ –∫ 1:
```{r}
library(car)
vif(model2)
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–¥–Ω–æ –∏–∑ –¥–æ–ø—É—â–µ–Ω–∏–π –±–∏–Ω–∞—Ä–Ω–æ–π –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –æ–¥–Ω–∞–∫–æ –¥–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π.